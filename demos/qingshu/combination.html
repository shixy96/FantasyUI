<script>
  init({
    title: 'Examples of Qingshu table usage',
    desc: 'User Plugin: qingshu/bootstrap-table-sticky-header, qingshu/bootstrap-table-fixed-columns',
    links: [
      'qingshu/bootstrap-table.min.css',
      'extensions/sticky-header/bootstrap-table-sticky-header.css',
      'extensions/fixed-columns/bootstrap-table-fixed-columns.min.css'
    ],
    scripts: [
      'qingshu/bootstrap-table.min.js',
      'qingshu/extensions/sticky-header/bootstrap-table-sticky-header.min.js',
      'qingshu/extensions/fixed-columns/bootstrap-table-fixed-columns.min.js',
      'qingshu/extensions/sticky-pagination/bootstrap-table-sticky-pagination.js'
    ]
  })
</script>

<style>
  .mr10 {margin-right: 10px;}
  .mb10 {margin-bottom: 10px;}
</style>

<div class="toolbar">
  <div>
    <label class="checkbox">
      <input id="height" type="checkbox"> Enable Height
    </label>
  </div>
  <div class="form-inline">
    <span class="mr10 mb10">Fixed Number: </span>
    <input class="form-control mr10 mb10" id="fixedNumber" type="number" value="0" min="1" max="5">
    <span class="mr10 mb10">Fixed Right Number: </span>
    <input class="form-control" id="fixedRightNumber" type="number" value="0" min="0" max="5">
  </div>
  <div class="form-inline">
    <span class="mr10 mb10">Cells: </span>
    <input class="form-control mr10 mb10" id="cells" type="number" value="10" min="1" max="30">
    <span class="mr10 mb10">Total: </span>
    <input class="form-control mr10 mb10" id="total" type="number" value="800" min="1" max="800">
    <span class="mr10 mb10">Sleep: </span>
    <input class="form-control mr10 mb10" id="sleep" type="number" value="100" min="0" max="1000">
    <button id="build" class="btn btn-secondary mb10">Rebuild Table</button>
  </div>
</div>

<div style="margin-bottom: 96px;">
  <table
    id="table"
    data-toggle="table"
    data-pagination="true"
    data-side-pagination="server"
    data-url="http://192.168.1.182:3000/examples/bootstrap_table/qs"
    data-query-params="queryParams"
    data-sticky-header="true"
  >
    <thead>
      <tr>
        <th data-field="field0" data-title="Cell0" data-sortable="true" data-formatter="itemFormat">field0</th>
        <th data-field="field1" data-title="Cell1" data-sortable="true" data-formatter="itemFormat">field1</th>
        <th data-field="field2" data-title="Cell2" data-sortable="true" data-formatter="itemFormat">field2</th>
        <th data-field="field3" data-title="Cell3" data-sortable="true" data-formatter="itemFormat">field3</th>
        <th data-field="field4" data-title="Cell4" data-sortable="true" data-formatter="itemFormat">field4</th>
        <th data-field="field5" data-title="Cell5" data-sortable="true" data-formatter="itemFormat">field5</th>
        <th data-field="field6" data-title="Cell6" data-sortable="true" data-formatter="itemFormat">field6</th>
        <th data-field="field7" data-title="Cell7" data-sortable="true" data-formatter="itemFormat">field7</th>
        <th data-field="field8" data-title="Cell8" data-sortable="true" data-formatter="itemFormat">field8</th>
        <th data-field="field9" data-title="Cell9" data-sortable="true" data-formatter="itemFormat">field9</th>
      </tr>
    </thead>
  </table>
</div>

<script>
  var $table = $('#table')

  function itemFormat(val, row) {
    return '<div class="item">' + val + '</div>'
  }

  function queryParams(params) {
    params.cols = +$('#cells').val()
    params.total = +$('#total').val()
    params.sleep = +$('#sleep').val()
    return params
  }

  function rebuildTable(init) {
    var cells = +$('#cells').val()
    var rows = +$('#rows').val()
    var i
    var j
    var row
    var columns = []
    var data = []

    for (i = 0; i < cells; i++) {
      columns.push({
        field: 'field' + i,
        title: 'Cell' + i,
        sortable: true,
        formatter: itemFormat
      })
    }
    console.log($table, $table.bootstrapTable)

    $table.bootstrapTable('destroy').bootstrapTable({
      height: $('#height').is(':checked') ? 600 : undefined,
      toolbar: '.toolbar',
      columns: columns,

      pagination: true,
      sidePagination: 'server',
      url: 'http://192.168.1.182:3000/examples/bootstrap_table/qs',

      fixedColumns: true,
      fixedNumber: +$('#fixedNumber').val(),
      fixedRightNumber: +$('#fixedRightNumber').val(),
      stickyHeader: true
    })
  }

  $('#build').click(function name(params) {
    rebuildTable()
  })
</script>
